<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Setting up a Liverpool Bay NEMO configuration &#8212; NEMO-RELOC 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="NEMO-RELOC 0.1 documentation" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="setting-up-a-liverpool-bay-nemo-configuration">
<h1>Setting up a Liverpool Bay NEMO configuration<a class="headerlink" href="#setting-up-a-liverpool-bay-nemo-configuration" title="Permalink to this headline">¶</a></h1>
<p>URL:: <a class="reference external" href="http://nemo-reloc.readthedocs.io/en/latest/LBay.html">http://nemo-reloc.readthedocs.io/en/latest/LBay.html</a></p>
<ul class="simple">
<li>Build notes with:: ~/GitLab/NEMO-RELOC/docs$ make html</li>
</ul>
<div class="section" id="issues-that-arose">
<h2>Issues that arose<a class="headerlink" href="#issues-that-arose" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Notes the <code class="docutils literal"><span class="pre">cpp_*.fcm</span></code> files are different:</p>
<p>diff /work/n01/n01/jelt/Solent/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/Solent/cpp_Solent.fcm /work/n01/n01/jelt/lighthousereef/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/LH_REEF/cpp_LH_REEF.fcm
1c1
&lt;  bld::tool::fppkeys key_trabbl key_dynspg_flt key_diaeiv key_ldfslp key_traldf_c2d key_traldf_eiv key_dynldf_c3d key_zdftke key_zdfddm key_zdftmx key_iomput key_mpp_mpi
&#8212;
&gt; bld::tool::fppkeys   key_dynspg_ts key_ldfslp  key_zdfgls  key_vvl key_mpp_mpi key_netcdf4 key_nosignedzero  key_iomput key_gen_IC key_bdy</p>
</li>
<li><p class="first">I didn&#8217;t copy some stuff into the NEMO compilation. This may be a problem later:</p>
<p>cp $WDIR/INPUTS/cpp_LH_REEF.fcm ./LH_REEF
cp $INPUTS/dtatsd.F90 LH_REEF/MY_SRC/</p>
</li>
<li><p class="first">PyNEMO doesn&#8217;t yet deal with sigma parent grids.</p>
</li>
</ul>
<p>Follow PyNEMO recipe for Lighthouse Reef: <code class="docutils literal"><span class="pre">http://pynemo.readthedocs.io/en/latest/examples.html#example-2-lighthouse-reef</span></code>
Follow PyNEMO recipe for Lighthouse Reef: <code class="docutils literal"><span class="pre">http://nemo-reloc.readthedocs.io/en/latest/SEAsia.html</span></code></p>
</div>
<hr class="docutils" />
<div class="section" id="recipe-notes">
<h2>Recipe Notes<a class="headerlink" href="#recipe-notes" title="Permalink to this headline">¶</a></h2>
<p>Define working directory and other useful shortcuts. Load modules:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>export WDIR=/work/n01/n01/jelt/LBay/
export INPUTS=/work/n01/n01/jelt/lighthousereef/INPUTS
export CDIR=$WDIR/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG
export TDIR=$WDIR/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/TOOLS

module swap PrgEnv-cray PrgEnv-intel
module load cray-netcdf-hdf5parallel
module load cray-hdf5-parallel
</pre></div>
</div>
<p>Follow recipe. Step 1 inlcuded getting INPUT files. For LHReef these were all
prepared. Now they are not so make them as and when they are required:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $WDIR
mkdir INPUTS
</pre></div>
</div>
<p>Old code:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">INPUTS</span>
<span class="n">wget</span> <span class="n">ftp</span><span class="o">.</span><span class="n">nerc</span><span class="o">-</span><span class="n">liv</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">uk</span><span class="p">:</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">general</span><span class="o">/</span><span class="n">jdha</span><span class="o">/</span><span class="n">inputs</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">tar</span> <span class="n">xvfz</span> <span class="n">inputs</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
<span class="n">rm</span> <span class="n">inputs</span><span class="o">.</span><span class="n">tar</span><span class="o">.</span><span class="n">gz</span>
</pre></div>
</div>
<p><em>Now</em> code:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $WDIR
svn co http://forge.ipsl.jussieu.fr/nemo/svn/branches/2014/dev_r4621_NOC4_BDY_VERT_INTERP@5709
svn co http://forge.ipsl.jussieu.fr/ioserver/svn/XIOS/branchs/xios-1.0@629
</pre></div>
</div>
<p>Need to get arch files from INPUTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $WDIR/xios-1.0
cp $INPUTS/arch-XC30_ARCHER.* ./arch
</pre></div>
</div>
<p>Implement make command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">make_xios</span> <span class="o">--</span><span class="n">full</span> <span class="o">--</span><span class="n">prod</span> <span class="o">--</span><span class="n">arch</span> <span class="n">XC30_ARCHER</span> <span class="o">--</span><span class="n">netcdf_lib</span> <span class="n">netcdf4_par</span>
</pre></div>
</div>
<p>Step 2. Obtain and apply patches:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>export CDIR=$WDIR/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG
export TDIR=$WDIR/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/TOOLS
cd $CDIR/../NEMO/OPA_SRC/SBC
patch -b &lt; $INPUTS/fldread.patch
cd ../DOM
patch -b &lt; $INPUTS/dommsk.patch
cd ../BDY
patch -b &lt; $INPUTS/bdyini.patch
cd $CDIR
rm $CDIR/../NEMO/OPA_SRC/TRD/trdmod.F90
cp $INPUTS/arch-* ../ARCH
</pre></div>
</div>
<p>Copy some input files to new configuration path:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cp $INPUTS/cpp_LH_REEF.fcm ./LBay/cpp_LBay.fcm
cp $INPUTS/dtatsd.F90 LBay/MY_SRC/
</pre></div>
</div>
<p>On first make only choose OPA_SRC:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">makenemo</span> <span class="o">-</span><span class="n">n</span> <span class="n">LBay</span> <span class="o">-</span><span class="n">m</span> <span class="n">XC_ARCHER_INTEL</span> <span class="o">-</span><span class="n">j</span> <span class="mi">10</span>
</pre></div>
</div>
<p>It breaks. Remove key_lim2 from cpp*fcm file and remake:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="n">LBay</span><span class="o">/</span><span class="n">cpp_LBay</span><span class="o">.</span><span class="n">fcm</span>
<span class="o">...</span>

<span class="o">./</span><span class="n">makenemo</span> <span class="o">-</span><span class="n">n</span> <span class="n">LBay</span> <span class="o">-</span><span class="n">m</span> <span class="n">XC_ARCHER_INTEL</span> <span class="o">-</span><span class="n">j</span> <span class="mi">10</span>
</pre></div>
</div>
<p>To generate bathymetry, initial conditions and grid information we first need
to compile some of the NEMO TOOLS (after a small bugfix - and to allow direct
passing of arguments). For some reason GRIDGEN doesn’t like INTEL:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $WDIR/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/TOOLS/WEIGHTS/src
patch -b &lt; $INPUTS/scripinterp_mod.patch
patch -b &lt; $INPUTS/scripinterp.patch
patch -b &lt; $INPUTS/scrip.patch
patch -b &lt; $INPUTS/scripshape.patch
patch -b &lt; $INPUTS/scripgrid.patch

cd ../../
./maketools -n WEIGHTS -m XC_ARCHER_INTEL
./maketools -n REBUILD_NEMO -m XC_ARCHER_INTEL

module unload cray-netcdf-hdf5parallel cray-hdf5-parallel
module swap PrgEnv-intel PrgEnv-cray
module load cray-netcdf cray-hdf5
./maketools -n GRIDGEN -m XC_ARCHER

module swap PrgEnv-cray PrgEnv-intel
</pre></div>
</div>
<p><em>(1 March 2017)</em></p>
<p>Need to take a more structured approach to setting up this new configuration</p>
<div class="section" id="generate-new-coordinates-file">
<h3>1. Generate new coordinates file<a class="headerlink" href="#generate-new-coordinates-file" title="Permalink to this headline">¶</a></h3>
<p>Generate a <code class="docutils literal"><span class="pre">coordinates.nc</span></code> file from a parent NEMO grid at some resolution.
<strong>Plan:</strong> Use tool <code class="docutils literal"><span class="pre">create_coordinates.exe</span></code> which reads cutting indices and
parent grid location from <code class="docutils literal"><span class="pre">namelist.input</span></code> and outputs a new files with new
resolution grid elements.</p>
<p>First we need to figure out the indices for the new domain, from the parent grid.
Move parent grid into INPUTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cp $INPUTS/coordinates_ORCA_R12.nc $WDIR/INPUTS/.
</pre></div>
</div>
<p>Inspect this parent coordinates file to define the boundary indices for the new config.</p>
<p>Note, I used FERRET locally:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$livljobs2$ scp jelt@login.archer.ac.uk:/work/n01/n01/jelt/LBay/INPUTS/coordinates_ORCA_R12.nc ~/Desktop/.
ferret etc
shade/i=3385:3392/j=2251:2266 NAV_LAT
shade/i=3385:3392/j=2251:2266 NAV_LON
</pre></div>
</div>
<p>Copy namelist file from LH_reef and edit with new indices, retaining use of
ORCA_R12 as course
parent grid:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $TDIR/GRIDGEN
cp $INPUTS/namelist_R12 ./
vi namelist_R12
...
cn_parent_coordinate_file = &#39;../../../../INPUTS/coordinates_ORCA_R12.nc&#39;
...
nn_imin = 3385
nn_imax = 3392
nn_jmin = 2251
nn_jmax = 2266
nn_rhox  = 7
nn_rhoy = 7

ln -s namelist_R12 namelist.input
./create_coordinates.exe
cp 1_coordinates_ORCA_R12.nc $WDIR/INPUTS/coordinates.nc
</pre></div>
</div>
<p>This creates a coordinates.nc file with contents, which are now copied to
INPUTS:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">dimensions</span><span class="p">:</span>
      <span class="n">x</span> <span class="o">=</span> <span class="mi">57</span> <span class="p">;</span>
      <span class="n">y</span> <span class="o">=</span> <span class="mi">113</span> <span class="p">;</span>
      <span class="n">z</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">;</span>
      <span class="n">time</span> <span class="o">=</span> <span class="n">UNLIMITED</span> <span class="p">;</span> <span class="o">//</span> <span class="p">(</span><span class="mi">1</span> <span class="n">currently</span><span class="p">)</span>
<span class="n">variables</span><span class="p">:</span>
  <span class="nb">float</span> <span class="n">nav_lon</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="nb">float</span> <span class="n">nav_lat</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="nb">float</span> <span class="n">nav_lev</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="p">;</span>
  <span class="nb">float</span> <span class="n">time</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
  <span class="nb">int</span> <span class="n">time_steps</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">glamt</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">glamu</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">glamv</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">glamf</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">gphit</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">gphiu</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">gphiv</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">gphif</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">e1t</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">e1u</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">e1v</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">e1f</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">e2t</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">e2u</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">e2v</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
  <span class="n">double</span> <span class="n">e2f</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="p">;</span>
</pre></div>
</div>
<p>Now we need to generate a bathymetry on this new grid.</p>
</div>
<div class="section" id="generate-bathymetry-file">
<h3>2. Generate bathymetry file<a class="headerlink" href="#generate-bathymetry-file" title="Permalink to this headline">¶</a></h3>
<p>Download some GEBCO data and copy to ARCHER:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">scp</span> <span class="o">~/</span><span class="n">Downloads</span><span class="o">/</span><span class="n">RN</span><span class="o">-</span><span class="mi">5922</span><span class="n">_1488296787410</span><span class="o">/</span><span class="n">GEBCO_2014_2D_</span><span class="o">-</span><span class="mf">4.7361</span><span class="n">_53</span><span class="o">.</span><span class="mi">0299</span><span class="n">_</span><span class="o">-</span><span class="mf">2.5941</span><span class="n">_54</span><span class="o">.</span><span class="mf">4256.</span><span class="n">nc</span> <span class="n">jelt</span><span class="nd">@login</span><span class="o">.</span><span class="n">archer</span><span class="o">.</span><span class="n">ac</span><span class="o">.</span><span class="n">uk</span><span class="p">:</span><span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">n01</span><span class="o">/</span><span class="n">n01</span><span class="o">/</span><span class="n">jelt</span><span class="o">/</span><span class="n">LBay</span><span class="o">/</span><span class="n">INPUTS</span><span class="o">/.</span>
</pre></div>
</div>
<p>Copy namelist for reshaping GEBCO data:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cp $INPUTS/namelist_reshape_bilin_gebco $WDIR/INPUTS/.
</pre></div>
</div>
<dl class="docutils">
<dt>Edit namelist to point to correct input file. Edit lat and lon variable names to</dt>
<dd>make sure they match the nc file content (used e.g.</dd>
</dl>
<p><code class="docutils literal"><span class="pre">ncdump</span> <span class="pre">-h</span> <span class="pre">GEBCO_2014_2D_-4.7361_53.0299_-2.5941_54.4256.nc</span></code> to get input
variable names):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>vi $WDIR/INPUTS/namelist_reshape_bilin_gebco
...
&amp;grid_inputs
  input_file = &#39;gebco_in.nc&#39;
  nemo_file = &#39;coordinates.nc&#39;
  ...
  input_lon = &#39;lon&#39;
  input_lat = &#39;lat&#39;
  nemo_lon = &#39;glamt&#39;
  nemo_lat = &#39;gphit&#39;
  ...

  &amp;interp_inputs
  input_file = &quot;gebco_in.nc&quot;
  ...
  input_name = &quot;elevation&quot;
</pre></div>
</div>
<p>Do some things to 1) flatten out land elevations, 2) make depths positive. <em>(James
noted a problem with the default nco module)</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $WDIR/INPUTS
module load nco/4.5.0
ncap2 -s &#39;where(elevation &gt; 0) elevation=0&#39; GEBCO_2014_2D_-4.7361_53.0299_-2.5941_54.4256.nc tmp.nc
ncflint --fix_rec_crd -w -1.0,0.0 tmp.nc tmp.nc gebco_in.nc
rm tmp.nc
</pre></div>
</div>
<p>Restore the original parallel modules, which were removed to fix tool building issue:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">module</span> <span class="n">unload</span> <span class="n">nco</span> <span class="n">cray</span><span class="o">-</span><span class="n">netcdf</span> <span class="n">cray</span><span class="o">-</span><span class="n">hdf5</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">cray</span><span class="o">-</span><span class="n">netcdf</span><span class="o">-</span><span class="n">hdf5parallel</span> <span class="n">cray</span><span class="o">-</span><span class="n">hdf5</span><span class="o">-</span><span class="n">parallel</span>
</pre></div>
</div>
<p>Execute first scrip thing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scripgrid.exe namelist_reshape_bilin_gebco
</pre></div>
</div>
<p>Output files:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">remap_nemo_grid_gebco</span><span class="o">.</span><span class="n">nc</span>
<span class="n">remap_data_grid_gebco</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<p>Execute second scip thing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scrip.exe namelist_reshape_bilin_gebco
</pre></div>
</div>
<p>Output files:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">data_nemo_bilin_gebco</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<p>Execute third scip thing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scripinterp.exe namelist_reshape_bilin_gebco
</pre></div>
</div>
<p>Output files:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">bathy_meter</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
</div>
<div class="section" id="generate-initial-conditions">
<h3>3. Generate initial conditions<a class="headerlink" href="#generate-initial-conditions" title="Permalink to this headline">¶</a></h3>
<p>Copy <code class="docutils literal"><span class="pre">make.macro</span></code> file and edit the path if necessary::
<strong>FIX</strong> to the notes (copied from jdha instead): <code class="docutils literal"><span class="pre">cp</span> <span class="pre">$WDIR/INPUTS/make.macro</span> <span class="pre">./</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">n01</span><span class="o">/</span><span class="n">n01</span><span class="o">/</span><span class="n">jdha</span><span class="o">/</span><span class="n">sosie</span><span class="o">/</span><span class="n">make</span><span class="o">.</span><span class="n">macro</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">n01</span><span class="o">/</span><span class="n">n01</span><span class="o">/</span><span class="n">jelt</span><span class="o">/</span><span class="n">sosie</span><span class="o">/.</span>

<span class="n">vi</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">n01</span><span class="o">/</span><span class="n">n01</span><span class="o">/</span><span class="n">jelt</span><span class="o">/</span><span class="n">sosie</span><span class="o">/</span><span class="n">make</span><span class="o">.</span><span class="n">macro</span>
<span class="c1"># Directory to install binaries:</span>
<span class="n">INSTALL_DIR</span> <span class="o">=</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">n01</span><span class="o">/</span><span class="n">n01</span><span class="o">/</span><span class="n">jelt</span><span class="o">/</span><span class="n">local</span>
</pre></div>
</div>
<p>Proceed with Step 6:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd ~
mkdir local
svn co svn://svn.code.sf.net/p/sosie/code/trunk sosie
cd sosie

make
make install
export PATH=~/local/bin:$PATH
cd $WDIR/INPUTS
</pre></div>
</div>
<p>Obtain the fields to interpolate. Interpolate AMM60
data. Get the namelists:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cp $INPUTS/initcd_votemper.namelist .
cp $INPUTS/initcd_vosaline.namelist .
</pre></div>
</div>
<p>Generate the actual files. Cut them out of something bigger. Use the same indices
as used in coordinates.nc (note that the nco tools don&#8217;t like the
parallel modules):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">----</span>
</pre></div>
</div>
<p><em>(3 March )</em>
Insert new method to use AMM60 data for initial conditions.
/work/n01/n01/kariho40/NEMO/NEMOGCM_jdha/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/AMM60smago/EXP_notradiff/OUTPUT
AMM60_5d_20131013_20131129_grid_T.nc</p>
<p>Find the AMM60 indices using FERRET on the bathy_meter.nc file: <code class="docutils literal"><span class="pre">shade</span> <span class="pre">log(Bathymetry[I=540:750,</span> <span class="pre">J=520:820])</span></code></p>
<p>Note that the temperature and salinity variables are <code class="docutils literal"><span class="pre">thetao</span></code> and <code class="docutils literal"><span class="pre">so</span></code></p>
<div class="highlight-default"><div class="highlight"><pre><span></span>module unload cray-netcdf-hdf5parallel cray-hdf5-parallel
module load cray-netcdf cray-hdf5
module load nco/4.5.0
cd $WDIR/INPUTS

ncks -d x,560,620 -d y,720,800 /work/n01/n01/kariho40/NEMO/NEMOGCM_jdha/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/AMM60smago/EXP_notradiff/OUTPUT/AMM60_5d_20131013_20131129_grid_T.nc $WDIR/INPUTS/cut_down_20131013_LBay_grid_T.nc
</pre></div>
</div>
<p>Average over time and restore the parallel modules:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ncwa -a time_counter $WDIR/INPUTS/cut_down_20131013_LBay_grid_T.nc  $WDIR/INPUTS/cut_down_201310_LBay_grid_T.nc

module unload nco cray-netcdf cray-hdf5
module load cray-netcdf-hdf5parallel cray-hdf5-parallel
</pre></div>
</div>
<p>Edit namelists:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="n">initcd_votemper</span><span class="o">.</span><span class="n">namelist</span>
<span class="n">cf_in</span>     <span class="o">=</span> <span class="s1">&#39;cut_down_201310_LBay_grid_T.nc&#39;</span>
<span class="n">cv_in</span>     <span class="o">=</span> <span class="s1">&#39;thetao&#39;</span>
<span class="n">cf_x_in</span>   <span class="o">=</span> <span class="s1">&#39;cut_down_201310_LBay_grid_T.nc&#39;</span>
<span class="n">cv_out</span>   <span class="o">=</span> <span class="s1">&#39;thetao&#39;</span>
<span class="n">csource</span>  <span class="o">=</span> <span class="s1">&#39;AMM60&#39;</span>
<span class="n">ctarget</span>  <span class="o">=</span> <span class="s1">&#39;LBay&#39;</span>

<span class="n">vi</span> <span class="n">initcd_vosaline</span><span class="o">.</span><span class="n">namelist</span>
<span class="o">...</span>
<span class="n">cv_out</span>   <span class="o">=</span> <span class="s1">&#39;so&#39;</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Do stuff. I think the intention was for SOSIE to flood fill the land:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sosie</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span><span class="n">f</span> <span class="n">initcd_votemper</span><span class="o">.</span><span class="n">namelist</span>
</pre></div>
</div>
<p>Creates:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">thetao_AMM60</span><span class="o">-</span><span class="n">LBay_2013</span><span class="o">.</span><span class="n">nc4</span>
<span class="n">sosie_mapping_AMM60</span><span class="o">-</span><span class="n">LBay</span><span class="o">.</span><span class="n">nc</span>
</pre></div>
</div>
<p>Repeat for salinity:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sosie</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span><span class="n">f</span> <span class="n">initcd_vosaline</span><span class="o">.</span><span class="n">namelist</span>
</pre></div>
</div>
<p>Creates:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">so_AMM60</span><span class="o">-</span><span class="n">LBay_2013</span><span class="o">.</span><span class="n">nc4</span>
</pre></div>
</div>
<p>Now do interpolation as before. First copy the namelists:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cp $INPUTS/namelist_reshape_bilin_initcd_votemper $WDIR/INPUTS/.
cp $INPUTS/namelist_reshape_bilin_initcd_vosaline $WDIR/INPUTS/.
</pre></div>
</div>
<p>Edit the input files:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>vi $WDIR/INPUTS/namelist_reshape_bilin_initcd_votemper
&amp;grid_inputs
  input_file = &#39;thetao_AMM60-LBay_2013.nc4&#39;
...

&amp;interp_inputs
  input_file = &quot;thetao_AMM60-LBay_2013.nc4&quot;
...
</pre></div>
</div>
<p>Simiarly for the <a href="#id1"><span class="problematic" id="id2">*</span></a>vosaline.nc file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>vi $WDIR/INPUTS/namelist_reshape_bilin_initcd_vosaline
&amp;grid_inputs
  input_file = &#39;so_AMM60-LBay_2013.nc4&#39;
...

&amp;interp_inputs
  input_file = &quot;so_AMM60-LBay_2013.nc4&quot;
...
</pre></div>
</div>
<p>Produce the remap files:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scripgrid.exe namelist_reshape_bilin_initcd_votemper
</pre></div>
</div>
<p>Creates <code class="docutils literal"><span class="pre">remap_nemo_grid_R12.nc</span></code> and <code class="docutils literal"><span class="pre">remap_data_grid_R12.nc</span></code>. Then:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scrip.exe namelist_reshape_bilin_initcd_votemper
</pre></div>
</div>
<p>Creates <code class="docutils literal"><span class="pre">data_nemo_bilin_R12.nc</span></code>. Then:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scripinterp.exe namelist_reshape_bilin_initcd_votemper
</pre></div>
</div>
<p>Creates <code class="docutils literal"><span class="pre">initcd_votemper.nc</span></code>. Then:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scripinterp.exe namelist_reshape_bilin_initcd_vosaline
</pre></div>
</div>
<p>Creates <code class="docutils literal"><span class="pre">initcd_vosaline.nc</span></code>.</p>
</div>
<div class="section" id="generate-weights-for-atm-forcing">
<h3>4. Generate weights for atm forcing<a class="headerlink" href="#generate-weights-for-atm-forcing" title="Permalink to this headline">¶</a></h3>
<p>Generate cut down drowned precip file (note that the nco tools don&#8217;t like the
parallel modules). <strong>HEALTH WARNING</strong> <em>Cut out files with only one index in that lat direction broke NEMO</em>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>module unload cray-netcdf-hdf5parallel cray-hdf5-parallel
module load cray-netcdf cray-hdf5
module load nco/4.5.0
ncks -d lon,355.,360. -d lat,48.,55. /work/n01/n01/acc/ORCA0083/NEMOGCM/CONFIG/R12_ORCA/EXP00/FORCING/drowned_precip_DFS5.1.1_y2000.nc $WDIR/INPUTS/cutdown_drowned_precip_DFS5.1.1_y2000.nc
ncks -d lon0,355.,360. -d lat0,48.,55. /work/n01/n01/acc/ORCA0083/NEMOGCM/CONFIG/R12_ORCA/EXP00/FORCING/drowned_u10_DFS5.1.1_y2000.nc $WDIR/INPUTS/cutdown_drowned_u10_DFS5.1.1_y2000.nc
ncks -d lon0,355.,360. -d lat0,48.,55. /work/n01/n01/acc/ORCA0083/NEMOGCM/CONFIG/R12_ORCA/EXP00/FORCING/drowned_v10_DFS5.1.1_y2000.nc $WDIR/INPUTS/cutdown_drowned_v10_DFS5.1.1_y2000.nc
ncks -d lon0,355.,360. -d lat0,48.,55. /work/n01/n01/acc/ORCA0083/NEMOGCM/CONFIG/R12_ORCA/EXP00/FORCING/drowned_radsw_DFS5.1.1_y2000.nc $WDIR/INPUTS/cutdown_drowned_radsw_DFS5.1.1_y2000.nc
ncks -d lon0,355.,360. -d lat0,48.,55. /work/n01/n01/acc/ORCA0083/NEMOGCM/CONFIG/R12_ORCA/EXP00/FORCING/drowned_radlw_DFS5.1.1_y2000.nc $WDIR/INPUTS/cutdown_drowned_radlw_DFS5.1.1_y2000.nc
ncks -d lon0,355.,360. -d lat0,48.,55. /work/n01/n01/acc/ORCA0083/NEMOGCM/CONFIG/R12_ORCA/EXP00/FORCING/drowned_t2_DFS5.1.1_y2000.nc $WDIR/INPUTS/cutdown_drowned_t2_DFS5.1.1_y2000.nc
ncks -d lon0,355.,360. -d lat0,48.,55. /work/n01/n01/acc/ORCA0083/NEMOGCM/CONFIG/R12_ORCA/EXP00/FORCING/drowned_q2_DFS5.1.1_y2000.nc $WDIR/INPUTS/cutdown_drowned_q2_DFS5.1.1_y2000.nc
ncks -d lon0,355.,360. -d lat0,48.,55. /work/n01/n01/acc/ORCA0083/NEMOGCM/CONFIG/R12_ORCA/EXP00/FORCING/drowned_snow_DFS5.1.1_y2000.nc $WDIR/INPUTS/cutdown_drowned_snow_DFS5.1.1_y2000.nc

module unload nco/4.5.0
module unload cray-netcdf cray-hdf5
module load cray-netcdf-hdf5parallel cray-hdf5-parallel
</pre></div>
</div>
<p>Obtain namelist files and data file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cp $INPUTS/namelist_reshape_bilin_atmos $WDIR/INPUTS/.
cp $INPUTS/namelist_reshape_bicubic_atmos $WDIR/INPUTS/.
</pre></div>
</div>
<p>Edit namelist to reflect source filenames (just a year change):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>vi $WDIR/INPUTS/namelist_reshape_bilin_atmos
...
&amp;grid_inputs
    input_file = &#39;cutdown_drowned_precip_DFS5.1.1_y2000.nc&#39;

vi $WDIR/INPUTS/namelist_reshape_bicubic_atmos
...
&amp;grid_inputs
  input_file = &#39;cutdown_drowned_precip_DFS5.1.1_y2000.nc&#39;
</pre></div>
</div>
<p>Setup weights files for the atmospheric forcing:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $WDIR/INPUTS
$TDIR/WEIGHTS/scripgrid.exe namelist_reshape_bilin_atmos
</pre></div>
</div>
<p>Generate  remap files <code class="docutils literal"><span class="pre">remap_nemo_grid_atmos.nc</span></code> and <code class="docutils literal"><span class="pre">remap_data_grid_atmos.nc</span></code>. Then:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scrip.exe namelist_reshape_bilin_atmos
</pre></div>
</div>
<p>Generates <code class="docutils literal"><span class="pre">data_nemo_bilin_atmos.nc</span></code>. Then:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scripshape.exe namelist_reshape_bilin_atmos
</pre></div>
</div>
<p>Generates <code class="docutils literal"><span class="pre">weights_bilinear_atmos.nc</span></code>. Then:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scrip.exe namelist_reshape_bicubic_atmos
</pre></div>
</div>
<p>Generates <code class="docutils literal"><span class="pre">data_nemo_bicubic_atmos.nc</span></code>. Then:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/WEIGHTS/scripshape.exe namelist_reshape_bicubic_atmos
</pre></div>
</div>
<p>Generates <code class="docutils literal"><span class="pre">weights_bicubic_atmos.nc</span></code>.</p>
</div>
<div class="section" id="generate-mesh-and-mask-files-for-open-boundary-conditions">
<h3>5. Generate mesh and mask files for open boundary conditions<a class="headerlink" href="#generate-mesh-and-mask-files-for-open-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>Run the model to generate the mesh and mask files:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $CDIR
cp $INPUTS/cpp_LH_REEF.fcm LBay/cpp_LBay.fcm
ln -s $WDIR/INPUTS/bathy_meter.nc $CDIR/LBay/EXP00/bathy_meter.nc
ln -s $WDIR/INPUTS/coordinates.nc $CDIR/LBay/EXP00/coordinates.nc
cp $INPUTS/runscript $CDIR/LBay/EXP00
cp $INPUTS/namelist_cfg $CDIR/LBay/EXP00/namelist_cfg
cp $INPUTS/namelist_ref $CDIR/LBay/EXP00/namelist_ref
./makenemo clean
./makenemo -n LBay -m XC_ARCHER_INTEL -j 10
cd LBay/EXP00
ln -s $WDIR/xios-1.0/bin/xios_server.exe xios_server.exe
</pre></div>
</div>
<p>Edit the namelist files for this configuration:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ncdump -h coordinates.nc
x = 57 ;
y = 113 ;

vi namelist.cfg
...
cn_exp      =   &quot;LBay&quot;  !  experience name
...
!-----------------------------------------------------------------------
&amp;namcfg        !   parameters of the configuration
!-----------------------------------------------------------------------
   cp_cfg      =  &quot;lbay&quot;                !  name of the configuration
   jp_cfg      =     084               !  resolution of the configuration
   jpidta      =      57               !  1st lateral dimension ( &gt;= jpi )
   jpjdta      =     113               !  2nd    &quot;         &quot;    ( &gt;= jpj )
   jpkdta      =      51               !  number of levels      ( &gt;= jpk )
   jpiglo      =      57               !  1st dimension of global domain --&gt; i =jpidta
   jpjglo      =     113               !  2nd    -                  -    --&gt; j  =jpjdta
</pre></div>
</div>
<p><strong>ACTION: There are further edits to be made for when the model is actually run</strong>
<strong>E.g. other filename instances of Lbay</strong></p>
<p>Note that the old LH_REEF has the following
| jpidta      =     358               !  1st lateral dimension ( &gt;= jpi )
| jpjdta      =     428               !  2nd    &#8221;         &#8221;    ( &gt;= jpj )</p>
<p>with the dimensions in the LH_REFF coordinates file as
| ncdump -h coordinates.nc
| x = 358 ;
| y = 428 ;</p>
<p>Edit the runscript to include modules and the Account name (n01-NOCL):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">vi</span> <span class="n">runscript</span>

<span class="c1">#!/bin/bash</span>
<span class="c1">#PBS -N LBay</span>
<span class="c1">#PBS -l select=5</span>
<span class="c1">#PBS -l walltime=00:20:00</span>
<span class="c1">#PBS -A n01-NOCL</span>

<span class="n">module</span> <span class="n">swap</span> <span class="n">PrgEnv</span><span class="o">-</span><span class="n">cray</span> <span class="n">PrgEnv</span><span class="o">-</span><span class="n">intel</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">cray</span><span class="o">-</span><span class="n">netcdf</span><span class="o">-</span><span class="n">hdf5parallel</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">cray</span><span class="o">-</span><span class="n">hdf5</span><span class="o">-</span><span class="n">parallel</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Submit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">qsub</span> <span class="o">-</span><span class="n">q</span> <span class="n">short</span> <span class="n">runscript</span>
</pre></div>
</div>
<p><em>(6 March 2017)</em></p>
<p>If that works, we then need to rebuild the mesh and mask files in to single files for the next step:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$TDIR/REBUILD_NEMO/rebuild_nemo -t 24 mesh_zgr 96
$TDIR/REBUILD_NEMO/rebuild_nemo -t 24 mesh_hgr 96
$TDIR/REBUILD_NEMO/rebuild_nemo -t 24 mask 96
mv mesh_zgr.nc mesh_hgr.nc mask.nc $WDIR/INPUTS
rm mesh_* mask_* LBay_0000*
cd $WDIR/INPUTS
</pre></div>
</div>
</div>
<div class="section" id="generate-boundary-conditions-with-pynemo-create-netcdf-abstraction-wrapper">
<h3>6. Generate boundary conditions with PyNEMO: Create netcdf abstraction wrapper<a class="headerlink" href="#generate-boundary-conditions-with-pynemo-create-netcdf-abstraction-wrapper" title="Permalink to this headline">¶</a></h3>
<p><em>(Reinstall pyNEMO, with updates, 10 March 2017)</em>
In this section there are two stages.
* generate a ncml file which describes the files needed to create boundary conditions
* generate a namelist.bdy file which controls the actual boundary condition generation.</p>
<p>For each parent data set a new pair of (<code class="docutils literal"><span class="pre">*.ncml</span></code>, <code class="docutils literal"><span class="pre">namelist.bdy</span></code>) are needed.
Here I attempt to use parent data from:
* AMM60 local data (doesn&#8217;t yet work because of the sigma levels)
* thredds server (as in the LH_REEF example)
* NNA local data (easiest ?)</p>
<p>First install PyNEMO if not already done so. Full description:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd ~
module load anaconda
conda create --name pynemo_env scipy=0.16.0 numpy matplotlib=1.5.1 basemap netcdf4 libgfortran=1.0.0
source activate pynemo_env
conda install -c conda-forge seawater=3.3.4
conda install -c https://conda.anaconda.org/srikanthnagella thredds_crawler
conda install -c https://conda.anaconda.org/srikanthnagella pyjnius
export LD_LIBRARY_PATH=/opt/java/jdk1.7.0_45/jre/lib/amd64/server:$LD_LIBRARY_PATH
svn checkout https://ccpforge.cse.rl.ac.uk/svn/pynemo
cd pynemo/trunk/Python
python setup.py build
export PYTHONPATH=/home/n01/n01/jelt/.conda/envs/pynemo_env/lib/python2.7/site-packages/:$PYTHONPATH
python setup.py install --prefix ~/.conda/envs/pynemo_env
#cp data/namelist.bdy $WDIR
cd $WDIR
</pre></div>
</div>
<p>The first time I did this I copied the PyNEMO namelist.bdy file into $WDIR.
<code class="docutils literal"><span class="pre">#cp</span> <span class="pre">data/namelist.bdy</span> <span class="pre">$WDIR</span></code>. Subsequently I generalised this (and moved to INPUTS)
<code class="docutils literal"><span class="pre">cd</span> <span class="pre">$WDIR/INPUTS;</span> <span class="pre">cp</span> <span class="pre">$INPUTS/namelist.bdy</span> <span class="pre">$WDIR/INPUTS/.</span></code>. However, now I
suggest managing the namelist.bdy file
after the <code class="docutils literal"><span class="pre">ncml</span></code> file is generated. Hopefully edits here to this effect will
not break the workflow.</p>
</div>
<div class="section" id="a-generate-ncml-files">
<h3>6a. Generate ncml files<a class="headerlink" href="#a-generate-ncml-files" title="Permalink to this headline">¶</a></h3>
<p>Activate generator:</p>
<p>Start up pynemo and generate boundary conditions. First we need to create a
few ncml files to gather input data and map variable names. Then using pynemo
we define the area we want to model.
Redefine <code class="docutils literal"><span class="pre">WDIR</span></code>. Launch from WDIR:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ssh -Y espp1
module load anaconda
source activate pynemo_env
#  export LD_LIBRARY_PATH=/opt/java/jdk1.7.0_45/jre/lib/amd64/server:$LD_LIBRARY_PATH
#  export PYTHONPATH=/home/n01/n01/jelt/.conda/envs/pynemo_env/lib/python2.7/site-packages/:$PYTHONPATH
cd $WDIR/INPUTS
pynemo_ncml_generator
</pre></div>
</div>
<p>Here the object is to generate a ncml file that is read in by PyNEMO as the <code class="docutils literal"><span class="pre">sn_src_dir</span></code>
(in the <code class="docutils literal"><span class="pre">namelist.bdy</span></code> file)</p>
<p>Fill in the Tracer and Dynamics for T,S,U,V,Z tabs: using T,T &amp; U,V,T in the reg
expressions e.g. .*T.nc$
To generate a e.g. <code class="docutils literal"><span class="pre">inputs_src.ncml</span></code> file click  <strong>generate</strong>. Defining the
filename seems to work better with the file selector rather than direct typing.</p>
<p>In the following I have three ncml files.
* One for using the thredds server to get remote ORCA12 data.
* One for using local AMM60 data, with ackward s-sigma levels
* One for using local NNA data</p>
</div>
<div class="section" id="nna-inputs-src-ncml">
<h3>NNA_inputs_src.ncml<a class="headerlink" href="#nna-inputs-src-ncml" title="Permalink to this headline">¶</a></h3>
<p>Note need to set the time variables and new <code class="docutils literal"><span class="pre">sn_src_dir</span></code> in namelist.bdy.
Actually upated the following with all the Jan 2000 files:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $WDIR/INPUTS
vi NNA_inputs_src.ncml

&lt;ns0:netcdf xmlns:ns0=&quot;http://www.unidata.ucar.edu/namespaces/netcdf/ncml-2.2&quot; title=&quot;NEMO aggregation&quot;&gt;
  &lt;ns0:aggregation type=&quot;union&quot;&gt;
    &lt;ns0:netcdf&gt;
      &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;votemper&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:scan location=&quot;file://work/n01/n01/jdha/LBay/INPUTS/NNA&quot; regExp=&quot;.*T\.nc$&quot; /&gt;
      &lt;/ns0:aggregation&gt;
    &lt;/ns0:netcdf&gt;
    &lt;ns0:netcdf&gt;
      &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;vosaline&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:scan location=&quot;file://work/n01/n01/jdha/LBay/INPUTS/NNA&quot; regExp=&quot;.*T\.nc$&quot; /&gt;
      &lt;/ns0:aggregation&gt;
    &lt;/ns0:netcdf&gt;
    &lt;ns0:netcdf&gt;
      &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;vozocrtx&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:scan location=&quot;file://work/n01/n01/jdha/LBay/INPUTS/NNA&quot; regExp=&quot;.*U\.nc$&quot; /&gt;
      &lt;/ns0:aggregation&gt;
    &lt;/ns0:netcdf&gt;
    &lt;ns0:netcdf&gt;
      &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;vomecrty&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:scan location=&quot;file://work/n01/n01/jdha/LBay/INPUTS/NNA&quot; regExp=&quot;.*V\.nc$&quot; /&gt;
      &lt;/ns0:aggregation&gt;
    &lt;/ns0:netcdf&gt;
    &lt;ns0:netcdf&gt;
      &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;sossheig&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:scan location=&quot;file://work/n01/n01/jdha/LBay/INPUTS/NNA&quot; regExp=&quot;.*T\.nc$&quot; /&gt;
      &lt;/ns0:aggregation&gt;
    &lt;/ns0:netcdf&gt;
  &lt;/ns0:aggregation&gt;
&lt;/ns0:netcdf&gt;
</pre></div>
</div>
</div>
<div class="section" id="amm60-inputs-src-ncml">
<h3>AMM60_inputs_src.ncml<a class="headerlink" href="#amm60-inputs-src-ncml" title="Permalink to this headline">¶</a></h3>
<p>This is <strong>untested</strong> in pynemo because pynemo can&#8217;t handle interpolation of sigma
coordinate parent data. It currently assumes all the points are on the same geopotential.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $WDIR/INPUTS
vi AMM60_inputs_src.ncml

&lt;ns0:netcdf xmlns:ns0=&quot;http://www.unidata.ucar.edu/namespaces/netcdf/ncml-2.2&quot; title=&quot;NEMO aggregation&quot;&gt;
  &lt;ns0:aggregation type=&quot;union&quot;&gt;
    &lt;ns0:netcdf&gt;
      &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;temperature&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:scan location=&quot;file://work/n01/n01/kariho40/NEMO/NEMOGCM_jdha/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/AMM60smago/EXP_notradiff/OUTPUT&quot; regExp=&quot;AMM60_1d_20120221_20120420_grid_T\.nc$&quot; /&gt;
      &lt;/ns0:aggregation&gt;
    &lt;/ns0:netcdf&gt;
    &lt;ns0:netcdf&gt;
      &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;salinity&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:scan location=&quot;file://work/n01/n01/kariho40/NEMO/NEMOGCM_jdha/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/AMM60smago/EXP_notradiff/OUTPUT&quot; regExp=&quot;AMM60_1d_20120221_20120420_grid_T\.nc$&quot; /&gt;
      &lt;/ns0:aggregation&gt;
    &lt;/ns0:netcdf&gt;
    &lt;ns0:netcdf&gt;
      &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;zonal_velocity&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:scan location=&quot;file://work/n01/n01/kariho40/NEMO/NEMOGCM_jdha/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/AMM60smago/EXP_notradiff/OUTPUT&quot; regExp=&quot;AMM60_1d_20120221_20120420_grid_U\.nc$&quot; /&gt;
      &lt;/ns0:aggregation&gt;
    &lt;/ns0:netcdf&gt;
    &lt;ns0:netcdf&gt;
      &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;meridian_velocity&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:scan location=&quot;file://work/n01/n01/kariho40/NEMO/NEMOGCM_jdha/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/AMM60smago/EXP_notradiff/OUTPUT&quot; regExp=&quot;AMM60_1d_20120221_20120420_grid_V\.nc$&quot; /&gt;
      &lt;/ns0:aggregation&gt;
    &lt;/ns0:netcdf&gt;
    &lt;ns0:netcdf&gt;
      &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;sea_surface_height&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:scan location=&quot;file://work/n01/n01/kariho40/NEMO/NEMOGCM_jdha/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/AMM60smago/EXP_notradiff/OUTPUT&quot; regExp=&quot;AMM60_1d_20120221_20120420_grid_T\.nc$&quot; /&gt;
      &lt;/ns0:aggregation&gt;
    &lt;/ns0:netcdf&gt;
  &lt;/ns0:aggregation&gt;
&lt;/ns0:netcdf&gt;
</pre></div>
</div>
</div>
<div class="section" id="thredds-inputs-src-ncml">
<h3>thredds_inputs_src.ncml<a class="headerlink" href="#thredds-inputs-src-ncml" title="Permalink to this headline">¶</a></h3>
<p><strong>Untested</strong>
In the pynemo_ncml_generator if using the thredds server use:
Source directory: <code class="docutils literal"><span class="pre">http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data</span></code></p>
<p><em>(16 March 2017)</em>
Created a thredds_inputs_src.ncml file to access ORCA12 data from the
thredds server. Note that the pynemo_ncml_generator populates this file with available
files according to the input regular expressions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $WDIR/INPUTS
vi thredds_inputs_src.ncml

&lt;ns0:netcdf xmlns:ns0=&quot;http://www.unidata.ucar.edu/namespaces/netcdf/ncml-2.2&quot; title=&quot;NEMO aggregation&quot;&gt;
&lt;ns0:aggregation type=&quot;union&quot;&gt;
  &lt;ns0:netcdf&gt;
    &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;temperature&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791206d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791201d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791126d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791121d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791116d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791111d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791106d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791101d05T.nc&quot; /&gt;
    &lt;/ns0:aggregation&gt;
  &lt;/ns0:netcdf&gt;
  &lt;ns0:netcdf&gt;
    &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;salinity&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791206d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791201d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791126d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791121d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791116d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791111d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791106d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791101d05T.nc&quot; /&gt;
    &lt;/ns0:aggregation&gt;
  &lt;/ns0:netcdf&gt;
  &lt;ns0:netcdf&gt;
    &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;zonal_velocity&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791206d05U.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791201d05U.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791126d05U.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791121d05U.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791116d05U.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791111d05U.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791106d05U.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791101d05U.nc&quot; /&gt;
    &lt;/ns0:aggregation&gt;
  &lt;/ns0:netcdf&gt;
  &lt;ns0:netcdf&gt;
    &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;meridian_velocity&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791206d05V.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791201d05V.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791126d05V.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791121d05V.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791116d05V.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791111d05V.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791106d05V.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791101d05V.nc&quot; /&gt;
    &lt;/ns0:aggregation&gt;
  &lt;/ns0:netcdf&gt;
  &lt;ns0:netcdf&gt;
    &lt;ns0:aggregation dimName=&quot;time_counter&quot; name=&quot;sea_surface_height&quot; type=&quot;joinExisting&quot;&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791206d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791201d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791126d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791121d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791116d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791111d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791106d05T.nc&quot; /&gt;
        &lt;ns0:netcdf location=&quot;http://esurgeod.noc.soton.ac.uk:8080/thredds/dodsC/PyNEMO/data/ORCA025-N206_19791101d05T.nc&quot; /&gt;
    &lt;/ns0:aggregation&gt;
  &lt;/ns0:netcdf&gt;
&lt;/ns0:aggregation&gt;
&lt;/ns0:netcdf&gt;
</pre></div>
</div>
</div>
<div class="section" id="b-generate-the-namelist-bdy-file-for-pynemo">
<h3>6b. Generate the namelist.bdy file for PyNEMO<a class="headerlink" href="#b-generate-the-namelist-bdy-file-for-pynemo" title="Permalink to this headline">¶</a></h3>
<p>Copy the PyNEMO template namelist.bdy from the lighthouse project:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cd $WDIR/INPUTS
cp $INPUTS/namelist.bdy $WDIR/INPUTS/.
</pre></div>
</div>
<p>Edit namelist.bdy to for the configuration name and <code class="docutils literal"><span class="pre">ncml</span></code> file name. <strong>Note
need the slash following OUTPUT</strong>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>vi namelist.bdy
sn_src_dir = &#39;./inputs_src.ncml&#39;       ! src_files/&#39;
sn_dst_dir = &#39;/work/n01/n01/jelt/LBay/OUTPUT/&#39;
sn_fn      = &#39;LBay&#39;                 ! prefix for output files
...
cn_mask_file   = &#39;./mask.nc&#39;                   !  name of mask file (if ln_mask_file=.TRUE.)
</pre></div>
</div>
<dl class="docutils">
<dt>Now edit the pynemo namelist file. Add location of grid information. Note had to</dt>
<dd><p class="first">hunt for a mesh.nc file. Incase this doesn&#8217;t work, there were a couple of
options. (Tried both) Note also that mesh_zgr includes gdept_0, gdepw_0, e3t_0, e3u_0,
e3v_0, e3w_0, so use ncml to convert to variables without <a href="#id3"><span class="problematic" id="id4">*</span></a>_0. (Also didn&#8217;t convert e3w_0).</p>
<p class="last">Make sure the timestamps correspond to the input data.</p>
</dd>
</dl>
<p>Turn off as many things as possible to help it along.
Turned off <code class="docutils literal"><span class="pre">ln_mask_file</span></code>. James said it was for outputting a new mask file
but it might have given me trouble.</p>
<p>I have a namelist.bdy file for each ncml configuration
* namelist.bdy_AMM60
* namelist.bdy_thredds (uses global 1/12 degree data)
* namelist.bdy_NNA</p>
<p>To use one copy e.g.:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="n">namelist</span><span class="o">.</span><span class="n">bdy_NNA</span> <span class="n">namelist</span><span class="o">.</span><span class="n">bdy</span>
</pre></div>
</div>
</div>
<div class="section" id="namelist-bdy-thredds">
<h3>namelist.bdy_thredds<a class="headerlink" href="#namelist-bdy-thredds" title="Permalink to this headline">¶</a></h3>
<p><strong>untested</strong> in LBay</p>
<p>I don&#8217;t know how to call the mesh.nc
mesh_zgr.nc, mesh_hgr.nc, mask.nc files from the thredds server so I pull them off
manually</p>
<p>This will overwrite the destination mesh and mask files. There is probably a wget
option to specify the write filename...:</p>
<p>NB try these locations. Previous locations are not European
| * /thredds/fileServer/PyNEMO/extra_data/NN_ORCA025-N206_19791106d05T.nc* includes UK
| <em>/thredds/fileServer/PyNEMO/grid_low_res_C/mask.nc</em></p>
<blockquote>
<div>mkdir tmp
cd tmp
wget <a class="reference external" href="http://esurgeod.noc.soton.ac.uk:8080/thredds/fileServer/PyNEMO/grid_low_res_C/mesh_zgr.nc">http://esurgeod.noc.soton.ac.uk:8080/thredds/fileServer/PyNEMO/grid_low_res_C/mesh_zgr.nc</a>
mv mesh_zgr.nc ../mesh_zgr_src.nc
wget <a class="reference external" href="http://esurgeod.noc.soton.ac.uk:8080/thredds/fileServer/PyNEMO/grid_low_res_C/mesh_hgr.nc">http://esurgeod.noc.soton.ac.uk:8080/thredds/fileServer/PyNEMO/grid_low_res_C/mesh_hgr.nc</a>
mv mesh_hgr.nc ../mesh_hgr_src.nc
wget <a class="reference external" href="http://esurgeod.noc.soton.ac.uk:8080/thredds/fileServer/PyNEMO/grid_low_res_C/mask.nc">http://esurgeod.noc.soton.ac.uk:8080/thredds/fileServer/PyNEMO/grid_low_res_C/mask.nc</a>
mv mask.nc ../mask_src.nc</div></blockquote>
<p>I had to regenerate the mesh_zgr.nc, mesh_hgr.nc and mask.nc files (I.e. run
nemo again. See above.)... Moving on, assuming that is done</p>
</div>
<div class="section" id="namelist-bdy-nna">
<h3>namelist.bdy_NNA<a class="headerlink" href="#namelist-bdy-nna" title="Permalink to this headline">¶</a></h3>
<p>Edit namelist.bdy to reflect locally stored mesh and mask files. Also
NNA_inputs_src.ncml. Set the date info back to Nov 1979.</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span>vi namelist.bdy

!!&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
!! NEMO/OPA  : namelist for BDY generation tool
!!
!!             User inputs for generating open boundary conditions
!!             employed by the BDY module in NEMO. Boundary data
!!             can be set up for v3.2 NEMO and above.
!!
!!             More info here.....
!!
!!&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;

!-----------------------------------------------------------------------
!   vertical coordinate
!-----------------------------------------------------------------------
   ln_zco      = .false.   !  z-coordinate - full    steps   (T/F)
   ln_zps      = .true.    !  z-coordinate - partial steps   (T/F)
   ln_sco      = .false.   !  s- or hybrid z-s-coordinate    (T/F)
   rn_hmin     =   -10     !  min depth of the ocean (&gt;0) or
                           !  min number of ocean level (&lt;0)

!-----------------------------------------------------------------------
!   s-coordinate or hybrid z-s-coordinate
!-----------------------------------------------------------------------
   rn_sbot_min =   10.     !  minimum depth of s-bottom surface (&gt;0) (m)
   rn_sbot_max = 7000.     !  maximum depth of s-bottom surface
                           !  (= ocean depth) (&gt;0) (m)
   ln_s_sigma  = .true.   !  hybrid s-sigma coordinates
   rn_hc       =  150.0    !  critical depth with s-sigma

!-----------------------------------------------------------------------
!  grid information
!-----------------------------------------------------------------------
   sn_src_hgr = &#39;/work/n01/n01/jdha/LBay/INPUTS/NNA/mesh_hgr.nc&#39;   !  /grid/
   sn_src_zgr = &#39;/work/n01/n01/jdha/LBay/INPUTS/NNA/mesh_zgr.nc&#39;
   sn_dst_hgr = &#39;./mesh_hgr.nc&#39;
   sn_dst_zgr = &#39;./inputs_dst.ncml&#39; ! rename output variables
   sn_src_msk = &#39;/work/n01/n01/jdha/LBay/INPUTS/NNA/mask.nc&#39;
   sn_bathy   = &#39;./bathy_meter.nc&#39;

!-----------------------------------------------------------------------
!  I/O
!-----------------------------------------------------------------------
   sn_src_dir = &#39;./NNA_inputs_src.ncml&#39;       ! src_files/&#39;
   sn_dst_dir = &#39;/work/n01/n01/jelt/LBay/INPUTS/&#39;
   sn_fn      = &#39;LBay&#39;                 ! prefix for output files
   nn_fv      = -1e20                     !  set fill value for output files
   nn_src_time_adj = 0                                    ! src time adjustment
   sn_dst_metainfo = &#39;metadata info: jelt&#39;


 !-----------------------------------------------------------------------
 !  unstructured open boundaries
 !-----------------------------------------------------------------------
     ln_coords_file = .true.               !  =T : produce bdy coordinates files
     cn_coords_file = &#39;coordinates.bdy.nc&#39; !  name of bdy coordinates files (if ln_coords_file=.TRUE.)
     ln_mask_file   = .false.              !  =T : read mask from file
     cn_mask_file   = &#39;./mask.nc&#39;                   !  name of mask file (if ln_mask_file=.TRUE.)
     ln_dyn2d       = .true.               !  boundary conditions for barotropic fields
     ln_dyn3d       = .true.               !  boundary conditions for baroclinic velocities
     ln_tra         = .true.               !  boundary conditions for T and S
     ln_ice         = .false.               !  ice boundary condition
     nn_rimwidth    = 9                    !  width of the relaxation zone

 !-----------------------------------------------------------------------
 !  unstructured open boundaries tidal parameters
 !-----------------------------------------------------------------------
     ln_tide        = .true.               !  =T : produce bdy tidal conditions
     clname(1)      = &#39;M2&#39;                 ! constituent name
     clname(2)      = &#39;S2&#39;
     clname(3)      = &#39;K2&#39;
     ln_trans       = .false.
     sn_tide_h     = &#39;/work/n01/n01/jelt/tpxo7.2/h_tpxo7.2.nc&#39;
     sn_tide_u     = &#39;/work/n01/n01/jelt/tpxo7.2/u_tpxo7.2.nc&#39;

 !-----------------------------------------------------------------------
 !  Time information
 !-----------------------------------------------------------------------
     nn_year_000     = 2000        !  year start
     nn_year_end     = 2000        !  year end
     nn_month_000    = 01          !  month start (default = 1 is years&gt;1)
     nn_month_end    = 01          !  month end (default = 12 is years&gt;1)
     sn_dst_calendar = &#39;gregorian&#39; !  output calendar format
     nn_base_year    = 1979        !  base year for time counter
     sn_tide_grid    = &#39;/work/n01/n01/jelt/tpxo7.2/grid_tpxo7.2.nc&#39;

 !-----------------------------------------------------------------------
 !  Additional parameters
 !-----------------------------------------------------------------------
     nn_wei  = 1                   !  smoothing filter weights
     rn_r0   = 0.041666666         !  decorrelation distance use in gauss
                                   !  smoothing onto dst points. Need to
                                   !  make this a funct. of dlon
     sn_history  = &#39;bdy files produced by jelt from AMM60 for testing&#39;
                                   !  history for netcdf file
     ln_nemo3p4  = .true.          !  else presume v3.2 or v3.3
     nn_alpha    = 0               !  Euler rotation angle
     nn_beta     = 0               !  Euler rotation angle
     nn_gamma    = 0               !  Euler rotation angle
     rn_mask_max_depth = 300.0     !  Maximum depth to be ignored for the mask
     rn_mask_shelfbreak_dist = 60    !  Distance from the shelf break
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="generate-boundary-conditions-with-pynemo-run-pynemo">
<h3>7. Generate boundary conditions with PyNEMO: Run PyNEMO<a class="headerlink" href="#generate-boundary-conditions-with-pynemo-run-pynemo" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span>ssh -Y espp1
module load anaconda
source activate pynemo_env

export LD_LIBRARY_PATH=/opt/java/jdk1.7.0_45/jre/lib/amd64/server:$LD_LIBRARY_PATH
#export PYTHONPATH=~/.conda/envs/pynemo_env/lib/python2.7/site-packages:$PYTHONPATH
cd $WDIR/INPUTS
pynemo -g -s namelist.bdy
</pre></div>
</div>
<p>Once the area of interest is selected and the close button is clicked, open
boundary data should be generated in $WDIR/OUTPUT</p>
<p>The SAVE button only updates the <code class="docutils literal"><span class="pre">namelist.bdy</span></code> file. The CLOSE button activates the process.</p>
<dl class="docutils">
<dt>This generates::</dt>
<dd><p class="first">ls -1 /work/n01/n01/jelt/LBay/OUTPUT</p>
<p class="last">coordinates.bdy.nc
LBay_bdyT_y2000m01.nc
LBay_bdyU_y2000m01.nc
LBay_bdyV_y2000m01.nc
LBay_bt_bdyT_y2000m01.nc</p>
</dd>
</dl>
</div>
<div class="section" id="run-the-configuration">
<h3>8. Run the configuration<a class="headerlink" href="#run-the-configuration" title="Permalink to this headline">¶</a></h3>
<dl class="docutils">
<dt>When I&#8217;ve got all the bdy files need to fix some variable names. Note have not</dt>
<dd><p class="first">yet got tidal forcing switched on:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span>exit
cd $WDIR/INPUTS
module unload cray-netcdf-hdf5parallel cray-hdf5-parallel
module load nco/4.5.0
ncrename -v deptht,gdept LBay_bdyT_y2000m01.nc
ncrename -v depthu,gdepu LBay_bdyU_y2000m01.nc
ncrename -v depthv,gdepv LBay_bdyV_y2000m01.nc
module unload nco
module load cray-netcdf-hdf5parallel cray-hdf5-parallel
</pre></div>
</div>
</dd>
<dt>Link the boundary data to the EXP direcory and update the namelist_cfg for</dt>
<dd><p class="first">running not mesh generation:</p>
<div class="last highlight-default"><div class="highlight"><pre><span></span>cd $CDIR/LBay/EXP00
ln -s $WDIR/INPUTS/coordinates.bdy.nc $CDIR/LBay/EXP00/coordinates.bdy.nc
ln -s $WDIR/INPUTS/LBay_bdyT_y2000m01.nc $CDIR/LBay/EXP00/LBay_bdyT_y2000m01.nc
ln -s $WDIR/INPUTS/LBay_bdyU_y2000m01.nc    $CDIR/LBay/EXP00/LBay_bdyU_y2000m01.nc
ln -s $WDIR/INPUTS/LBay_bdyV_y2000m01.nc    $CDIR/LBay/EXP00/LBay_bdyV_y2000m01.nc
ln -s $WDIR/INPUTS/LBay_bt_bdyT_y2000m01.nc  $CDIR/LBay/EXP00/LBay_bt_bdyT_y2000m01.nc
sed -e &#39;s/nn_msh      =    3/nn_msh      =    0/&#39; namelist_cfg &gt; tmp
sed -e &#39;s/nn_itend    =      1/nn_itend    =       1440 /&#39; tmp &gt; namelist_cfg
</pre></div>
</div>
</dd>
</dl>
<p>Should also check the xml files. There was something <strong>fishy</strong> with the
<code class="docutils literal"><span class="pre">field_def.xml</span></code> and <code class="docutils literal"><span class="pre">iodef.xml</span></code> files where variables were not defined in</p>
<blockquote>
<div><p>the NEMO checkout. Copy these files from lighthouse reef:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>cp /work/n01/n01/jelt/lighthousereef/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/LH_REEF/EXP00/iodef.xml  $CDIR/LBay/EXP00/iodef.xml
cp /work/n01/n01/jelt/lighthousereef/dev_r4621_NOC4_BDY_VERT_INTERP/NEMOGCM/CONFIG/SHARED/field_def.xml  $CDIR/SHARED/field_def.xml
</pre></div>
</div>
</div></blockquote>
<p>Increase the number of XIOS cores used:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>aprun -b -n 5 -N 5 ./xios_server.exe : -n $OCEANCORES -N 24 ./opa
#aprun -b -n $XIOCORES -N 1 ./xios_server.exe : -n $OCEANCORES -N 24 ./opa
</pre></div>
</div>
<p>Then submit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">qsub</span> <span class="o">-</span><span class="n">q</span> <span class="n">short</span> <span class="n">runscript</span>

<span class="mf">4401084.</span><span class="n">sdb</span>
</pre></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="tidal-boundary-conditions">
<h3>Tidal boundary conditions<a class="headerlink" href="#tidal-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p>Try turning of the 3d velocities:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>vi namelist.bdy::
..
ln_dyn2d       = .true.               !  boundary conditions for barotropic fields
ln_dyn3d       = .false.               !  boundary conditions for baroclinic velocities
ln_tra         = .true.               !  boundary conditions for T and S
</pre></div>
</div>
<p>Generate the boundary conditions again, with PyNEMO</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ssh -Y espp1
module load anaconda
source activate pynemo_env

export LD_LIBRARY_PATH=/opt/java/jdk1.7.0_45/jre/lib/amd64/server:$LD_LIBRARY_PATH
#export PYTHONPATH=~/.conda/envs/pynemo_env/lib/python2.7/site-packages:$PYTHONPATH
cd $WDIR/INPUTS
pynemo -g -s namelist.bdy
</pre></div>
</div>
<p>Didn&#8217;t work. Also tried setting all these things to false:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>vi namelist.bdy::
..
ln_dyn2d       = .false.               !  boundary conditions for barotropic fields
ln_dyn3d       = .false.               !  boundary conditions for baroclinic velocities
ln_tra         = .false.               !  boundary conditions for T and S
</pre></div>
</div>
<p>Didn&#8217;t produce tidal boundary files.</p>
<p>&#8212;</p>
<p>(9 Aug 17)</p>
<p>Try and pick up this thread and get tidal boundary conditions working.
The error logs suggested that a 3D array was expected when a 4D array was given.
Fix with running python and put back into source python.</p>
<p>Fatal Java error, so try a new java build too (jdk1.8.0_51). No it doesn&#8217;t exist.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ssh -Y espp1
module load anaconda
vi /home/n01/n01/jelt/.conda/envs/pynemo_env/lib/python2.7/site-packages/pynemo-0.2-py2.7.egg/pynemo/tide/nemo_bdy_tide3.py
...
#e3X = zgr[&#39;e3u&#39;][:,:,:].squeeze()
e3X = zgr[&#39;e3u&#39;][:].squeeze() # jelt 9 Aug 17: Generalise array dimensions to accomodate 4D data
...
#e3X = zgr[&#39;e3v&#39;][:,:,:].squeeze()
e3X = zgr[&#39;e3v&#39;][:].squeeze() # jelt 9 Aug 17: Generalise array dimensions to accomodate 4D data
...

source activate pynemo_env
export WDIR=/work/n01/n01/jelt/LBay/
export LD_LIBRARY_PATH=/opt/java/jdk1.7.0_45/jre/lib/amd64/server:$LD_LIBRARY_PATH

cd $WDIR/INPUTS
pynemo -g -s namelist.bdy
</pre></div>
</div>
<p>JAVA fatal error. Recompile pyNEMO (first move pynemo_env to pynemo_env2).
Use <em>nrct</em> instead of <em>pynemo</em> name</p>
<p>First install PyNEMO if not already done so. Full description:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>ssh -Y espp1
cd ~
module load anaconda/4.3.1-python2
conda create --name nrct_env scipy=0.16.0 numpy matplotlib=1.5.1 basemap netcdf4 libgfortran=1.0.0
source activate nrct_env
conda install -c conda-forge seawater=3.3.4
conda install -c https://conda.anaconda.org/srikanthnagella thredds_crawler
conda install -c https://conda.anaconda.org/srikanthnagella pyjnius
#export LD_LIBRARY_PATH=/opt/java/jdk1.7.0_45/jre/lib/amd64/server:$LD_LIBRARY_PATH
export LD_LIBRARY_PATH=/usr/lib64/jvm/jre-1.7.0-ibm/bin/j9vm:$LD_LIBRARY_PATH

git clone https://jpolton@bitbucket.org/jdha/nrct.git
cd nrct/Python
python setup.py build
export PYTHONPATH=/home/n01/n01/jelt/.conda/envs/nrct_env/lib/python2.7/site-packages/:$PYTHONPATH

python setup.py install --prefix ~/.conda/envs/nrct_env
export WDIR=/work/n01/n01/jelt/LBay/
</pre></div>
</div>
<p># Perhaps change the path where java is sought: $whereis java
#  export PATH=/usr/lib64/jvm/java-1.7.0-ibm-1.7.0:$PATH
# Didn&#8217;t work but maybe I didn&#8217;t do it properly</p>
<dl class="docutils">
<dt>Find the shared object libjvm.so in</dt>
<dd>/usr/lib64/jvm/jre-1.7.0-ibm/bin/j9vm</dd>
<dt>and link to this instead::</dt>
<dd>export LD_LIBRARY_PATH=/usr/lib64/jvm/jre-1.7.0-ibm/bin/j9vm:$LD_LIBRARY_PATH</dd>
</dl>
<p>conda install libxcb # Works but didn&#8217;t resolve problems.</p>
<blockquote>
<div><p>cd $WDIR
pynemo -g -s namelist.bdy</p>
<p>Errors. Errors. Can I do it on livljobs4?</p>
<p>(11/15 Aug 17)</p>
<p>First install PyNEMO if not already done so. Full description:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ssh</span> <span class="o">-</span><span class="n">Y</span> <span class="n">livljobs4</span>
<span class="n">cd</span> <span class="o">/</span><span class="n">work</span><span class="o">/</span><span class="n">jelt</span>
<span class="n">mkdir</span> <span class="o">/</span><span class="n">scratch</span><span class="o">/</span><span class="n">jelt</span><span class="o">/</span><span class="n">LBay</span>
<span class="n">export</span> <span class="n">WDIR</span><span class="o">=/</span><span class="n">scratch</span><span class="o">/</span><span class="n">jelt</span><span class="o">/</span><span class="n">LBay</span><span class="o">/</span>
<span class="n">module</span> <span class="n">load</span> <span class="n">anaconda</span><span class="o">/</span><span class="mf">2.1</span><span class="o">.</span><span class="mi">0</span>  <span class="c1"># Want python2</span>
<span class="n">conda</span> <span class="n">create</span> <span class="o">--</span><span class="n">name</span> <span class="n">nrct_env</span> <span class="n">scipy</span><span class="o">=</span><span class="mf">0.16</span><span class="o">.</span><span class="mi">0</span> <span class="n">numpy</span> <span class="n">matplotlib</span><span class="o">=</span><span class="mf">1.5</span><span class="o">.</span><span class="mi">1</span> <span class="n">basemap</span> <span class="n">netcdf4</span> <span class="n">libgfortran</span><span class="o">=</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span>
<span class="n">source</span> <span class="n">activate</span> <span class="n">nrct_env</span>

<span class="n">mkdir</span> <span class="o">/</span><span class="n">scratch</span><span class="o">/</span><span class="n">jelt</span><span class="o">/</span><span class="n">LBay</span>
<span class="n">export</span> <span class="n">WDIR</span><span class="o">=/</span><span class="n">scratch</span><span class="o">/</span><span class="n">jelt</span><span class="o">/</span><span class="n">LBay</span><span class="o">/</span>

<span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">conda</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">conda</span><span class="o">-</span><span class="n">forge</span> <span class="n">seawater</span><span class="o">=</span><span class="mf">3.3</span><span class="o">.</span><span class="mi">4</span> <span class="c1"># Note had to add https path</span>
<span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">conda</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">srikanthnagella</span> <span class="n">thredds_crawler</span>
<span class="n">conda</span> <span class="n">install</span> <span class="o">-</span><span class="n">c</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">conda</span><span class="o">.</span><span class="n">anaconda</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">srikanthnagella</span> <span class="n">pyjnius</span>
</pre></div>
</div>
</div></blockquote>
<p>Find java object by doing a which java and then following the trail
find  /usr/lib/jvm/jre-1.7.0-openjdk.x86_64/ -name libjvm.so -print</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>export LD_LIBRARY_PATH=/usr/lib/jvm/jre-1.7.0-openjdk.x86_64/lib/amd64/server:$LD_LIBRARY_PATH

unset SSH_ASKPASS # Didn&#39;t need this on ARCHER...
git clone https://jpolton@bitbucket.org/jdha/nrct.git nrct  # Give jpolton@bitbucket passwd
cd nrct/Python
python setup.py build
export PYTHONPATH=/home/n01/n01/jelt/.conda/envs/nrct_env/lib/python2.7/site-packages/:$PYTHONPATH

python setup.py install --prefix ~/.conda/envs/nrct_env

cd $WDIR/INPUTS
pynemo -g -s namelist.bdy
</pre></div>
</div>
<p># Java problems on ARCHER. OK on livljobs4</p>
<p>Seemed to have made some progress. Copied namelist.bdy from ARCHER $WDIR/INPUTS.
Might be an issue with some java libraries being in the path.</p>
<p>Really need to do a clean version on livljobs4</p>
<p>&#8212;</p>
<p><em>(20 Sept 2017)</em></p>
<p><strong>Start the process again on livljobs4: LBay_livljobs4.rst</strong></p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Setting up a Liverpool Bay NEMO configuration</a><ul>
<li><a class="reference internal" href="#issues-that-arose">Issues that arose</a></li>
<li><a class="reference internal" href="#recipe-notes">Recipe Notes</a><ul>
<li><a class="reference internal" href="#generate-new-coordinates-file">1. Generate new coordinates file</a></li>
<li><a class="reference internal" href="#generate-bathymetry-file">2. Generate bathymetry file</a></li>
<li><a class="reference internal" href="#generate-initial-conditions">3. Generate initial conditions</a></li>
<li><a class="reference internal" href="#generate-weights-for-atm-forcing">4. Generate weights for atm forcing</a></li>
<li><a class="reference internal" href="#generate-mesh-and-mask-files-for-open-boundary-conditions">5. Generate mesh and mask files for open boundary conditions</a></li>
<li><a class="reference internal" href="#generate-boundary-conditions-with-pynemo-create-netcdf-abstraction-wrapper">6. Generate boundary conditions with PyNEMO: Create netcdf abstraction wrapper</a></li>
<li><a class="reference internal" href="#a-generate-ncml-files">6a. Generate ncml files</a></li>
<li><a class="reference internal" href="#nna-inputs-src-ncml">NNA_inputs_src.ncml</a></li>
<li><a class="reference internal" href="#amm60-inputs-src-ncml">AMM60_inputs_src.ncml</a></li>
<li><a class="reference internal" href="#thredds-inputs-src-ncml">thredds_inputs_src.ncml</a></li>
<li><a class="reference internal" href="#b-generate-the-namelist-bdy-file-for-pynemo">6b. Generate the namelist.bdy file for PyNEMO</a></li>
<li><a class="reference internal" href="#namelist-bdy-thredds">namelist.bdy_thredds</a></li>
<li><a class="reference internal" href="#namelist-bdy-nna">namelist.bdy_NNA</a></li>
<li><a class="reference internal" href="#generate-boundary-conditions-with-pynemo-run-pynemo">7. Generate boundary conditions with PyNEMO: Run PyNEMO</a></li>
<li><a class="reference internal" href="#run-the-configuration">8. Run the configuration</a></li>
<li><a class="reference internal" href="#tidal-boundary-conditions">Tidal boundary conditions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/LBay.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, NOC.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.9</a>
      
      |
      <a href="_sources/LBay.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>